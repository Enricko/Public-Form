<!-- Settings page for PublicForum - will be loaded into the page-content div -->

<div class="card settings-card">
  <div class="card-header">
    <h4>Settings</h4>
  </div>
  
  <div class="card-body">
    <form id="settingsForm">
      <!-- Notification Setting -->
      <div class="setting-section">
        <div class="setting-row">
          <div class="setting-row-text">
            <div class="setting-label">Email Notifications</div>
            <div class="setting-description">Receive email updates about activity on PublicForum</div>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="emailToggle" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
      
      <!-- Email Setting -->
      <div class="setting-section">
        <div class="setting-label">Email Address</div>
        <button type="button" class="btn btn-setting" data-bs-toggle="modal" data-bs-target="#emailModal">
          <span id="currentEmailDisplay">user@example.com</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
      
      <!-- Password Setting -->
      <div class="setting-section">
        <div class="setting-label">Password</div>
        <button type="button" class="btn btn-setting" data-bs-toggle="modal" data-bs-target="#passwordModal">
          <span>Change password</span>
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </form>
    
  </div>
</div>

<!-- Email Change Modal -->
<div class="modal fade" id="emailModal" tabindex="-1" aria-labelledby="emailModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="emailModalLabel">Change Email</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="emailChangeForm">
          <div class="mb-3">
            <label for="currentEmail" class="setting-label">Current Email</label>
            <input type="email" class="form-control" id="currentEmail" value="user@example.com" disabled />
          </div>
          <div class="mb-3">
            <label for="newEmail" class="setting-label">New Email</label>
            <input type="email" class="form-control" id="newEmail" placeholder="Enter new email" required />
          </div>
          <div class="mb-3">
            <label for="confirmPassword" class="setting-label">Confirm Password</label>
            <input type="password" class="form-control" id="confirmPassword" placeholder="Enter your password" required />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="saveEmailBtn">Save Changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Password Change Modal -->
<div class="modal fade" id="passwordModal" tabindex="-1" aria-labelledby="passwordModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="passwordModalLabel">Change Password</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="passwordChangeForm">
          <div class="mb-3">
            <label for="currentPassword" class="setting-label">Current Password</label>
            <input type="password" class="form-control" id="currentPassword" placeholder="Enter current password" required />
          </div>
          <div class="mb-3">
            <label for="newPassword" class="setting-label">New Password</label>
            <input type="password" class="form-control" id="newPassword" placeholder="Enter new password" required />
          </div>
          <div class="mb-3">
            <label for="confirmNewPassword" class="setting-label">Confirm New Password</label>
            <input type="password" class="form-control" id="confirmNewPassword" placeholder="Confirm new password" required />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="savePasswordBtn">Save Changes</button>
      </div>
    </div>
  </div>
</div>

<style>
  /* Settings page specific styles */
  .settings-card {
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }
  
  .card-header {
    background-color: #fff;
    border-bottom: 1px solid #edeff1;
    padding: 16px 20px;
  }
  
  .card-header h4 {
    margin: 0;
    font-size: 18px;
    font-weight: 500;
  }
  
  .card-body {
    padding: 20px;
  }
  
  /* Setting styles */
  .setting-section {
    margin-bottom: 20px;
  }
  
  .setting-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
  }
  
  .setting-row-text {
    flex: 1;
  }
  
  .setting-label {
    font-weight: 500;
    font-size: 14px;
    color: #1c1c1c;
    margin-bottom: 6px;
  }
  
  .setting-description {
    font-size: 12px;
    color: #7c7c7c;
  }
  
  /* Toggle switch */
  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 48px;
    height: 24px;
  }
  
  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  
  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
  }
  
  .toggle-slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }
  
  input:checked + .toggle-slider {
    background-color: #e6443c;
  }
  
  input:checked + .toggle-slider:before {
    transform: translateX(24px);
  }
  
  /* Setting buttons */
  .btn-setting {
    background-color: #f6f7f8;
    border: 1px solid #edeff1;
    color: #1c1c1c;
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    text-align: left;
    padding: 12px 16px;
    border-radius: 4px;
  }
  
  .btn-setting:hover {
    background-color: #eee;
  }
  
  .btn-setting i {
    color: #7c7c7c;
  }
  
  /* Alert styling */
  .alert-success {
    background-color: #f6f7f8;
    border-left: 4px solid #43a047;
    color: #1c1c1c;
    border-radius: 0;
    font-size: 14px;
    padding: 12px 16px;
  }
  
  /* Modal customizations */
  .modal-content {
    border-radius: 4px;
    border: none;
  }
  
  .modal-header {
    border-bottom: 1px solid #edeff1;
    padding: 16px 20px;
  }
  
  .modal-body {
    padding: 20px;
  }
  
  .modal-footer {
    border-top: 1px solid #edeff1;
    padding: 12px 16px;
  }
  
  /* Button styling */
  .btn-danger {
    background-color: #e6443c;
    border-color: #e6443c;
  }
  
  .btn-danger:hover {
    background-color: #d13c34;
    border-color: #d13c34;
  }
  
  .btn-secondary {
    background-color: transparent;
    border: 1px solid #edeff1;
    color: #7c7c7c;
  }
  
  .btn-secondary:hover {
    background-color: #f6f7f8;
    color: #1c1c1c;
  }
</style>

<script>
  // Handle main settings form submission
  document.getElementById('settingsForm').addEventListener('submit', function(e) {
    e.preventDefault();  // Prevent form submission
    
    // Simulate API call to save settings
    setTimeout(() => {
      document.getElementById('settingsSuccessMessage').style.display = 'block';
      document.getElementById('settingsSuccessMessage').textContent = 'Your settings have been successfully updated!';
      
      // Hide success message after 3 seconds
      setTimeout(() => {
        document.getElementById('settingsSuccessMessage').style.display = 'none';
      }, 3000);
    }, 1000);
  });

  // Handle email change
  document.getElementById('saveEmailBtn').addEventListener('click', function() {
    const newEmail = document.getElementById('newEmail').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    if (newEmail && confirmPassword) {
      // Simulate API call to change email
      setTimeout(() => {
        // Close modal
        const emailModal = bootstrap.Modal.getInstance(document.getElementById('emailModal'));
        emailModal.hide();
        
        // Update displayed email
        document.getElementById('currentEmailDisplay').textContent = newEmail;
        document.getElementById('currentEmail').value = newEmail;
        
        // Show success message
        document.getElementById('settingsSuccessMessage').textContent = 'Your email has been successfully updated!';
        document.getElementById('settingsSuccessMessage').style.display = 'block';
        
        // Hide success message after 3 seconds
        setTimeout(() => {
          document.getElementById('settingsSuccessMessage').style.display = 'none';
        }, 3000);
        
        // Clear form
        document.getElementById('newEmail').value = '';
        document.getElementById('confirmPassword').value = '';
      }, 1000);
    }
  });

  // Handle password change
  document.getElementById('savePasswordBtn').addEventListener('click', function() {
    const currentPassword = document.getElementById('currentPassword').value;
    const newPassword = document.getElementById('newPassword').value;
    const confirmNewPassword = document.getElementById('confirmNewPassword').value;
    
    if (currentPassword && newPassword && confirmNewPassword) {
      if (newPassword !== confirmNewPassword) {
        alert('New passwords do not match!');
        return;
      }
      
      // Simulate API call to change password
      setTimeout(() => {
        // Close modal
        const passwordModal = bootstrap.Modal.getInstance(document.getElementById('passwordModal'));
        passwordModal.hide();
        
        // Show success message
        document.getElementById('settingsSuccessMessage').textContent = 'Your password has been successfully updated!';
        document.getElementById('settingsSuccessMessage').style.display = 'block';
        
        // Hide success message after 3 seconds
        setTimeout(() => {
          document.getElementById('settingsSuccessMessage').style.display = 'none';
        }, 3000);
        
        // Clear form
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmNewPassword').value = '';
      }, 1000);
    }
  });
</script>